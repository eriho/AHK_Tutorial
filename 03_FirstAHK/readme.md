# はじめてのAHKコード

## 始めに

今回はAHKの基本的なコードの書き方を学ぶために以下の題材を取り上げます。

**エクセルでコピーしたグラフをワードで拡張メタファイルで貼り付けをワンタッチで行う**

とても単純ですが、AHKのコードの最重要エッセンスが含まれています。是非自分で書いて(写して)実行してみて下さい。

## 実行したいことをまとめる

始めにでも述べたように、目的は「エクセルのグラフをワードで拡張メタファイルで貼り付けをワンタッチで行う」です。まず一番最初に行うことは、**自分が行う操作を書き出してみる**ことです。こうすることで、何をどのような順番でAHKのコードにするのかが明確になります。

それでは、皆さんもエクセルとワードを立ち上げて実際に貼り付けてみて下さい。それを書き下してみると、多少人によって違うと思いますが、以下のようになると思います。

1. エクセルでのグラフをクリップボードにコピーは、既に行っているものとする
1. また、ワードで貼り付けたい場所にカーソルを置いているものとする
1. **Alt**キーを押す。

	* すると上部メニュー(リボンと言います)に黄色のアルファベットが出る。

1. **H**キーを押す。

	* するとリボンの「ホーム」が選択される

1. **V**キーを押す

	* すると「ホーム」タブの「貼り付け」に移動する

1. **S**キーを押す

	* すると「貼り付け」の中で「形式を選択して貼り付け」が選択される。

1. 「形式を選択して貼り付け」のウィンドウが表示されたら、**上**キーを四回押す。

	* すると「拡張メタファイル」にカーソルが移動する。

1. **Enter**キーを押す。

	* すると「拡張メタファイル」で貼り付けが実行される。

このように、自分が実行する操作を順番に書いてみましょう。それができれば後は一つ一つの操作をAHKの命令に置き換えていくだけです。

## 今回のコード

それでは上の手順をAHKのコードにしたものを以下に示します。

```AutoHotkey::

;wordに形式を選択して貼り付けを行うAHK
;前提条件
;エクセルの図をクリップボードに貼り付けている状態から始める
;ウィンドウフォーカスはwordに合わせておく


#k::												;起動のショートカットキーを設定する
{														;スクリプトの中身を示すかっこを付ける
	send, !hvs								;sendでキーボードのキーを送る
	sleep, 500								;sleepで少し待つ。
	send, {up}{up}{up}{up}		;sendで矢印上を4回送る
	sleep, 500								;sleepで少し待つ
	send, {enter}							;enterキーを押す。
	return										;スクリプトの終了を示すreturnを送る
}														;本体部分の終了のかっこを付ける
```

