# AHKでいろいろやってみよう(その3)

## 本記事で学べること

今回は配列について書きたいと思います。配列とは、複数の値をまとめて扱うことのできる箱のようなもので、その箱から一つずつ順番に値を取り出すこともできます。そのため、配列の中身を一つずつ順番に取り出しながらループを実行する`for`も一緒に説明します。

* 配列の定義の仕方
* 配列を上手く使った`for`による繰り返し

## 配列の定義の仕方

まず変数を思い出して下さい。変数は以下のように値を格納する名前のついた箱です。

```AutoHotkey::

myProjectFolder := .\projectResult\

```

変数が保持する値は1つですが、配列は**複数の値を格納する**箱です。

```AutoHotkey::

myFolders := Object()
myFolders := ["20_Jan","19_Dec","19_Nov"]
```

`myFolders`という名前を付けています。この部分は変数定義と変わりません。違うのは、配列を作成する時に`配列名:=Object()`と宣言を行うこと、そして配列の中身を入れる時に`[x,y,z]`のように鉤括弧で囲み、カンマで区切って複数の値を代入していることです。

* 以下のようなフォルダ構成を想定しています。今いるフォルダの下に3つのフォルダがあり、それぞれにres.csvというファイルが格納されています。ahkのコードはarrayFor.ahkです。

```
code/
	┣20_Jan
	┃	└ res.csv
	┣19_Dec
	┃	└ res.csv
	┣20_Jan
	┃	└ res.csv
	┗ arrayFor.ahk
```

ここで、3つのフォルダにある`res.csv`をメモ帳で順番に開くahkスクリプトを見てみましょう。以下のようになります。


```AutoHotkey::

myFolders := Object()

myFolders := ["20_Jan","19_Dec","19_Nov"]
thisFileName := "res.csv"

for index, myFolder in myFolders
{
	MsgBox , ループ%index%回目、フォルダ:  %myFolder% を開きます
	
}

return
```

このコードで`for`に注目して下さい。`for`は、配列(`myFolders`)からを一つずつ取り出して,**変数myFolderに入れて**、ループ処理を行うを行うことができます。forの直後の`index`は、現在何回目のループかを示す数値が自動で入る変数になります(1始まり)。

ここでは、`%myFolder%`の値がループ毎に変更されることによって、対象ファイルのフォルダを切り換えることができます。

forの使い方をまとめると以下のようになります。
```
for ループ回数, 配列を入れる変数 in 配列
	{
		処理
	}
```

このように、配列と一緒に`for`を用いることで、処理内容は一緒で一部分だけ変更したい、という時に便利なコマンドですので是非使ってみて下さい。

## 組み込み変数と起動用命令run

さて、更に発展させて、3つのフォルダに含まれているファイルをメモ帳で順番に開く、ということを実現してみましょう。

```

myFolders := Object()

myFolders := ["20_Jan","19_Dec","19_Nov"]
thisFileName := "res.csv"

for index, myFolder in myFolders
{
	Run, notepad.exe %A_ScriptDir%\%myFolder%\%thisFileName%
}

return
```

まず、`run, 起動させたい実行ファイル名`でwindowsの任意のコマンドを実行することができます。`notepad.exe`はメモ帳です。`excel.exe`ならばエクセルが起動します。注意点としては、パスが通っていればコマンド名だけで指定できますが、通っていない場合は場所を明示してコマンドを指定する必要があることです。

実行ファイル名の後には、その実行ファイルの引数を記載していくことができます。ここで`%`に囲まれた文字は変数を示しています。`%myFolder%`と`%thisFileName%`は先述しましたが、`%A_ScriptDir%`は何を指すのでしょうか？少なくとも自分では定義していません。

Aから始まる変数は**組み込み変数**と呼ばれ、AHKが自動で用意してくれる便利な変数です。`A_ScriptDir`はスクリプトのあるディレクトリパスを格納しています。
この組み込み変数を使うと、自分でスクリプトのある場所を書き写す手間から解放されるだけでなく、フォルダをコピーして他の人に渡したりする時でも動くというメリットがあります。例えば自分は`c:\myProgram\`の直下にこのフォルダを置いていたとしても、他の人は`d:\programming`に置きたいかもしれません。このような場合でも問題なく動作します。

組み込み変数の一覧は[こちら](http://ahkwiki.net/Variables)にありますので、是非一度ご覧になって、使えそうなものを頭の片隅に入れておくといいと思います。



